<html>
<head>
  <title>DM Content Engine Demo</title>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/static/css/site.css" rel="stylesheet">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
  <script src="/static/javascript/dmdebug.js"></script>
</head>

<body>
  <h2>{{.current.Name}}</h2>
  <div class="inline-tool">
     <span>
         <a href="/content/edit/{{.current.ID}}" class="action" title="Edit">
             <i class="far fa-edit"></i>
         </a>
     </span>
     {{if( gt .current.ParentID 0 )}}
     <span>
         <a href="/content/view/{{.current.ParentID}}" class="action" title="Go to parent">
             <i class="fas fa-chevron-circle-up"></i>
         </a>
     </span>
     {{end}}
 </div>
  <div class="tool">
      <div>
          <ul>
          {{range $index,$folder := .folders}}
            <div>
                <li>
                <a href="/content/view/{{$folder.ID}}">
                    <i class="icon-type  type-{{$folder.FolderType.Value}}"></i>{{$folder.Name}}</a>
                </li>
                </div>
          {{end}}
          </ul>
        </div>

      <div>
          {{range $index, $type := .current_def.AllowedTypes}}
            <a href="/content/new/{{$type}}/{{$.current.ID}}" class="btn btn-primary btn-sm">New {{$type}}</a> <br />
          {{end}}
      </div>
  </div>

  <div class="block">

  {{$fields := .current.DisplayIdentifierList}}

  <div>
  <table>
      <tr><td>ID: </td><td>{{.current.ID}}</td></tr>
      <tr><td>UID: </td><td>{{.current.UID}}</td></tr>
      <tr><td>CID: </td><td>{{.current.CID}}</td></tr>
      {{if .current_def.HasVersion}}
            <tr><td>Version: </td><td>{{.current.Version}}</td></tr>
      {{end}}
      <tr><td>Published: </td><td>{{call .format_time .current.Published}}</td></tr>
      <tr><td>Modified: </td><td>{{call .format_time .current.Modified}}</td></tr>
      <tr><td colspan="2"><hr /></td></tr>
  {{range $i, $identifier := $fields}}
  {{$value := $.current.Value $identifier }}
  <tr><td style="width: 150px">{{(index $.current_def.Fields $identifier).Name}}:</td>
    <td>
        {{if (eq $identifier "title")}}
            {{$value.ViewValue}}
        {{else}}
            {{$value}}
        {{end}}
    </td>
</tr>
  {{end}}
</table>
</div>


{{if eq .current.ContentType "article"}}
<h4>Related articles</h4>
<ul>
    {{range $i, $article := .current.Value "related_articles"}}
        <li><a href="{{$article.from_location}}">{{index $article "data"}} <i>{{index $article "description"}}</i></a></li>
    {{end}}
    <li>
        <a href="#" class="action" title="Add related articles">
               <i class="fas fa-plus-circle"></i>
                Add articles
        </a>
    </li>
</ul>

{{end}}

 {{if( gt (len .folder_list) 0 ) }}
  <h3>Folder under</h3>
  <div>
      {{range $index,$content := .folder_list}}
        <div style="padding:2px">
            <a href="/content/view/{{$content.ID}}" title="{{$content.ID}}"><i class="icon-type type-folder-{{$content.FolderType.Value}}"></i>{{$content.Name}}</a>
            <a href="/content/edit/{{$content.ID}}" class="action" title="Edit"><i class="far fa-edit"></i></a>
            <a href="/content/delete/{{$content.ID}}" class="action" title="Remove"><i class="far fa-trash-alt"></i></a>
        </div>
      {{end}}
  </div>
  {{end}}

{{if .list }}
  <h3>Contents under</h3>
  <div>
      {{range $index,$content := .list}}
            {{if eq $content.ContentType "image" }}
                <div class="blockview">
                    <a href="/static/images/{{$content.Path.Value}}">
                    <img src="/static/images/{{$content.Path.Value}}" />
                    <div>{{$content.ID}}. {{$content.Title.Value}}</div>
                    </a>
                </div>
            {{else}}
                <div style="border-bottom: 1px dotted #cccccc;">
                <span class="content-title">
                    <a href="/content/view/{{$content.ID}}">
                        {{$content.ID}}. {{$content.Name}}
                    </a>
                </span>
                <span>{{call $.format_time $content.Published}}</span> &nbsp;&nbsp;&nbsp;
                <a href="/content/edit/{{$content.ID}}" class="action" title="Edit"><i class="far fa-edit"></i></a>
                <a href="/content/version/{{$content.ID}}" class="action" title="Version history(current version: {{$content.Version}})"><i class="fas fa-history"></i></a>
                <a href="/content/delete/{{$content.ID}}" class="action" title="Remove"><i class="far fa-trash-alt"></i></a>
                </div>
             {{end}}

      {{end}}
  </div>
{{end}}

  </div>

  <div class="admin">
      Powered by <a href="#" class="dm-name">DM Content framework</a>
      <a href="/console/list" title="Go to DM administration console" class="admin-console"><i class="fas fa-tools"></i></a>
  </div>

</body>
</html>
